{
  "dslNameList": [
    "DefaultDSL",
    "HierarchyDSL",
    "ThinkingDSL",
    "TextLabelsDSL",
    "CodeFlowDSL",
    "ConnectorsDSL",
    "PicturesDSL",
    "TreeDSL",
    "KanbanDSL",
    "DataFlowDSL"
  ],
  "view": {
    "scale": 0.9693685456110025,
    "position": [
      4791.360913989641,
      -925.3743234081837
    ],
    "isGridOn": true
  },
  "model": "{ \"class\": \"GraphLinksModel\",\n  \"copiesArrays\": true,\n  \"copiesArrayObjects\": true,\n  \"copiesKey\": false,\n  \"linkKeyProperty\": \"key\",\n  \"linkFromPortIdProperty\": \"fromPort\",\n  \"linkToPortIdProperty\": \"toPort\",\n  \"nodeDataArray\": [\n{\"label\":\"AI Flow DSL Robot Websocket Client\",\"category\":\"TextLabels_Size5\",\"alignment\":\"0 0.5 0 0\",\"alignmentFocus\":\"0 0.5 0 0\",\"size\":\"2100 120\",\"key\":0,\"location\":\"5223.3245576819 -784.0065037111856\"},\n{\"label\":\"get cola bottle in right hand\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"get cola_bottle_1 table_1 hand_right\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":1,\"location\":\"5260 440\",\"editorPosition\":[371,718,542,96]},\n{\"label\":\"put toast in plate\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"put toast_1 plate_1\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":2,\"location\":\"5270 350\",\"editorPosition\":[371,718,542,96]},\n{\"label\":\"put toast in toaster\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"put toast_1 toaster_1\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":3,\"location\":\"5270 260\",\"editorPosition\":[371,718,542,96]},\n{\"label\":\"get toast\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"get toast_1\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":4,\"location\":\"5270 170\",\"editorPosition\":[371,718,542,96]},\n{\"label\":\"get_state\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"get_state\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":5,\"location\":\"5270 80\",\"editorPosition\":[371,718,542,96]},\n{\"label\":\"Execution Engine\",\"category\":\"Hierarchy_Engine\",\"size\":\"240 80\",\"isFile\":true,\"fileType\":\"text/javascript\",\"fileContent\":\"var event, obj, nodeData;\\n  // Uncomment the next line to start debugging\\n  //debugger;\\nconsole.log( 'NodeData Info: '+JSON.stringify( nodeData ) );\\nconsole.log( 'Button Label: '+obj.data.name );\\nconsole.log( 'Button Status: '+obj.data.checked );\",\"buttons_\":[{\"name\":\"Reset\",\"checked\":true},{\"name\":\"Step\",\"checked\":false}],\"props_\":[{\"name\":\"isAutostart\",\"value\":\"false\"},{\"name\":\"isStepByStep\",\"value\":\"false\"},{\"name\":\"isStepByStepDeepFirst\",\"value\":\"true\"},{\"name\":\"isPersistent\",\"value\":\"false\"},{\"name\":\"isNodePersistencyUsed\",\"value\":\"true\"}],\"key\":6,\"location\":\"5413.3245576819 -629.0065037111856\"},\n{\"label\":\"Environement State\",\"category\":\"DataFlow_Data\",\"size\":\"290 80\",\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"{\\n  \\\"gaze\\\": {\\n    \\\"fovea\\\": [],\\n    \\\"perif\\\": []\\n  },\\n  \\\"hand_left\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": []\\n  },\\n  \\\"hand_right\\\": {\\n    \\\"holdsObject\\\": [\\n      \\\"cola_bottle_1\\\"\\n    ],\\n    \\\"isHeldByObject\\\": []\\n  },\\n  \\\"lab\\\": {\\n    \\\"holdsObject\\\": [\\n      \\\"table_1\\\"\\n    ]\\n  },\\n  \\\"table_1\\\": {\\n    \\\"holdsObject\\\": [\\n      \\\"fridge_1\\\",\\n      \\\"microwave_1\\\",\\n      \\\"toaster_1\\\",\\n      \\\"plate_1\\\",\\n      \\\"glass_1\\\",\\n      \\\"mug_1\\\",\\n      \\\"pitcher_1\\\",\\n      \\\"pitcher_2\\\"\\n    ],\\n    \\\"isHeldByObject\\\": [\\n      \\\"lab\\\"\\n    ]\\n  },\\n  \\\"fridge_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"closure\\\": \\\"closed\\\",\\n    \\\"power\\\": \\\"on\\\",\\n    \\\"temperature\\\": -5\\n  },\\n  \\\"microwave_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"closure\\\": \\\"closed\\\",\\n    \\\"power\\\": \\\"off\\\",\\n    \\\"temperature\\\": 20\\n  },\\n  \\\"toaster_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"power\\\": \\\"off\\\",\\n    \\\"temperature\\\": 20\\n  },\\n  \\\"plate_1\\\": {\\n    \\\"holdsObject\\\": [\\n      \\\"toast_1\\\"\\n    ],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"temperature\\\": 20\\n  },\\n  \\\"toast_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"plate_1\\\"\\n    ],\\n    \\\"temperature\\\": 20,\\n    \\\"preparation\\\": \\\"raw\\\"\\n  },\\n  \\\"cola_bottle_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"hand_right\\\"\\n    ],\\n    \\\"closure\\\": \\\"closed\\\",\\n    \\\"temperature\\\": 20,\\n    \\\"volume\\\": 0.5,\\n    \\\"fillLevel\\\": 0.5,\\n    \\\"holdsLiquid\\\": [\\n      \\\"coca-cola\\\"\\n    ]\\n  },\\n  \\\"glass_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"temperature\\\": 20,\\n    \\\"volume\\\": 0.1,\\n    \\\"fillLevel\\\": 0,\\n    \\\"holdsLiquid\\\": []\\n  },\\n  \\\"mug_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"temperature\\\": \\\"ambiant\\\",\\n    \\\"volume\\\": 0.1,\\n    \\\"fillLevel\\\": 0,\\n    \\\"holdsLiquid\\\": []\\n  },\\n  \\\"pitcher_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"temperature\\\": 20,\\n    \\\"volume\\\": 1,\\n    \\\"fillLevel\\\": 1,\\n    \\\"holdsLiquid\\\": [\\n      \\\"water\\\"\\n    ]\\n  },\\n  \\\"pitcher_2\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ],\\n    \\\"temperature\\\": 20,\\n    \\\"volume\\\": 1,\\n    \\\"fillLevel\\\": 1,\\n    \\\"holdsLiquid\\\": [\\n      \\\"coffee\\\"\\n    ]\\n  },\\n  \\\"tray_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ]\\n  },\\n  \\\"tea_bag_1\\\": {\\n    \\\"holdsObject\\\": [],\\n    \\\"isHeldByObject\\\": [\\n      \\\"table_1\\\"\\n    ]\\n  }\\n}\",\"fileTypeName\":\"JSON\",\"fileType\":\"text/json\",\"iconURL\":\"fileServer/pictures/JSON_Data.png\",\"key\":7,\"location\":\"6320 140\",\"editorPosition\":[859,7,427,1000]},\n{\"label\":\"{\\\"bbq_sauce_bottle\\\":{\\\"closure\\\":[false],\\\"color\\\":\\\"RED\\\",\\\"fillLevel\\\":0.5,\\\"holdsLiquid\\\":[\\\"bbq_sauce\\\"],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"shelf\\\"],\\\"type\\\":\\\"bottle\\\",\\\"volume\\\":0.5},\\\"black_olives\\\":{\\\"color\\\":\\\"BLACK_RUBBER\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"black_olives_bowl\\\"],\\\"type\\\":\\\"ingredient\\\",\\\"volume\\\":0.0},\\\"black_olives_bowl\\\":{\\\"color\\\":\\\"EMERALD\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[\\\"black_olives\\\"],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"bowl\\\",\\\"volume\\\":0.5},\\\"fresh_tomatoes\\\":{\\\"color\\\":\\\"RED\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"fresh_tomatoes_bowl\\\"],\\\"type\\\":\\\"ingredient\\\",\\\"volume\\\":0.0},\\\"fresh_tomatoes_bowl\\\":{\\\"color\\\":\\\"EMERALD\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[\\\"fresh_tomatoes\\\"],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"bowl\\\",\\\"volume\\\":0.5},\\\"gaze\\\":{\\\"fovea\\\":[],\\\"isHeldByObject\\\":[\\\"robot\\\"],\\\"perif\\\":[\\\"table\\\",\\\"shelf\\\",\\\"bbq_sauce_bottle\\\",\\\"black_olives_bowl\\\",\\\"black_olives\\\",\\\"fresh_tomatoes_bowl\\\",\\\"fresh_tomatoes\\\",\\\"ham_bowl\\\",\\\"ham\\\",\\\"mozzarella_cheese_bowl\\\",\\\"mozzarella_cheese\\\",\\\"olive_oil_bottle\\\",\\\"grapes1\\\",\\\"grapes2\\\",\\\"microwave\\\",\\\"peppers_bottle\\\",\\\"pesto_sauce_bottle\\\",\\\"pizza_dough_plate\\\",\\\"pizza_dough\\\",\\\"salt_bottle\\\",\\\"tomato_sauce_bottle\\\",\\\"tray\\\"]},\\\"grapes1\\\":{\\\"color\\\":\\\"BRICKRED\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"olive_oil_bottle\\\"],\\\"type\\\":\\\"ingredient\\\",\\\"volume\\\":0.0},\\\"grapes2\\\":{\\\"color\\\":\\\"BRICKRED\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"olive_oil_bottle\\\"],\\\"type\\\":\\\"ingredient\\\",\\\"volume\\\":0.0},\\\"ham\\\":{\\\"color\\\":\\\"MAGENTA\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"ham_bowl\\\"],\\\"type\\\":\\\"ingredient\\\",\\\"volume\\\":0.0},\\\"ham_bowl\\\":{\\\"color\\\":\\\"RUBY\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[\\\"ham\\\"],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"bowl\\\",\\\"volume\\\":0.5},\\\"hand_left\\\":{\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[],\\\"type\\\":\\\"hand\\\"},\\\"hand_right\\\":{\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[],\\\"type\\\":\\\"hand\\\"},\\\"lab\\\":{\\\"holdsObject\\\":[\\\"table\\\",\\\"shelf\\\"],\\\"isHeldByObject\\\":[],\\\"type\\\":\\\"room\\\"},\\\"microwave\\\":{\\\"color\\\":\\\"LIGHTGRAY\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"furniture\\\",\\\"volume\\\":0.0},\\\"mozzarella_cheese\\\":{\\\"color\\\":\\\"WHITE\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"mozzarella_cheese_bowl\\\"],\\\"type\\\":\\\"ingredient\\\",\\\"volume\\\":0.0},\\\"mozzarella_cheese_bowl\\\":{\\\"color\\\":\\\"RUBY\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[\\\"mozzarella_cheese\\\"],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"bowl\\\",\\\"volume\\\":0.5},\\\"olive_oil_bottle\\\":{\\\"closure\\\":[false],\\\"color\\\":\\\"EMERALD\\\",\\\"fillLevel\\\":1.0,\\\"holdsLiquid\\\":[\\\"olive_oil\\\"],\\\"holdsObject\\\":[\\\"grapes1\\\",\\\"grapes2\\\",\\\"grapes1\\\",\\\"grapes2\\\",\\\"grapes1\\\",\\\"grapes2\\\"],\\\"isHeldByObject\\\":[\\\"shelf\\\"],\\\"type\\\":\\\"bottle\\\",\\\"volume\\\":1.0},\\\"peppers_bottle\\\":{\\\"closure\\\":[false],\\\"color\\\":\\\"RUBY\\\",\\\"fillLevel\\\":0.5,\\\"holdsLiquid\\\":[\\\"peppers_bottle\\\"],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"shelf\\\"],\\\"type\\\":\\\"bottle\\\",\\\"volume\\\":0.5},\\\"pesto_sauce_bottle\\\":{\\\"closure\\\":[false],\\\"color\\\":\\\"GREEN\\\",\\\"fillLevel\\\":0.5,\\\"holdsLiquid\\\":[\\\"pesto_sauce\\\"],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"shelf\\\"],\\\"type\\\":\\\"bottle\\\",\\\"volume\\\":0.5},\\\"pizza_dough\\\":{\\\"color\\\":\\\"YELLOW\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"pizza_dough_plate\\\"],\\\"type\\\":\\\"pizza_dough\\\",\\\"volume\\\":0.8},\\\"pizza_dough_plate\\\":{\\\"color\\\":\\\"COPPER\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[\\\"pizza_dough\\\"],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"plate\\\",\\\"volume\\\":0.0},\\\"robot\\\":{\\\"holdsObject\\\":[\\\"gaze\\\",\\\"hand_left\\\",\\\"hand_right\\\"],\\\"isHeldByObject\\\":[\\\"lab\\\"],\\\"type\\\":\\\"robot\\\"},\\\"salt_bottle\\\":{\\\"color\\\":\\\"WHITE\\\",\\\"fillLevel\\\":0.5,\\\"holdsLiquid\\\":[\\\"salt\\\"],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"shelf\\\"],\\\"type\\\":\\\"bottle\\\",\\\"volume\\\":0.5},\\\"shelf\\\":{\\\"color\\\":\\\"BLACK_RUBBER\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[\\\"bbq_sauce_bottle\\\",\\\"olive_oil_bottle\\\",\\\"tomato_sauce_bottle\\\",\\\"salt_bottle\\\",\\\"pesto_sauce_bottle\\\",\\\"peppers_bottle\\\"],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"shelf\\\",\\\"volume\\\":0.0},\\\"table\\\":{\\\"color\\\":\\\"GRAY\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[\\\"shelf\\\",\\\"black_olives_bowl\\\",\\\"fresh_tomatoes_bowl\\\",\\\"ham_bowl\\\",\\\"mozzarella_cheese_bowl\\\",\\\"microwave\\\",\\\"pizza_dough_plate\\\",\\\"tray\\\"],\\\"isHeldByObject\\\":[],\\\"type\\\":\\\"furniture\\\",\\\"volume\\\":0.0},\\\"tomato_sauce_bottle\\\":{\\\"closure\\\":[false],\\\"color\\\":\\\"RED\\\",\\\"fillLevel\\\":0.5,\\\"holdsLiquid\\\":[\\\"tomato_sauce\\\"],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"shelf\\\"],\\\"type\\\":\\\"bottle\\\",\\\"volume\\\":0.5},\\\"tray\\\":{\\\"color\\\":\\\"LIGHTBLUE\\\",\\\"fillLevel\\\":0.0,\\\"holdsLiquid\\\":[],\\\"holdsObject\\\":[],\\\"isHeldByObject\\\":[\\\"table\\\"],\\\"type\\\":\\\"tray\\\",\\\"volume\\\":0.0}}\",\"category\":\"DataFlow_Message\",\"alignment\":\"0 0.5 0 0\",\"alignmentFocus\":\"0 0.5 0 0\",\"size\":\"2080 630\",\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"key\":8,\"location\":\"6730 150\"},\n{\"label\":\"Received response\",\"category\":\"DataFlow_Message\",\"alignment\":\"0 0.5 0 0\",\"alignmentFocus\":\"0 0.5 0 0\",\"size\":\"920 70\",\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"key\":9,\"location\":\"6330 610\"},\n{\"label\":\"Model\",\"size\":\"180 60\",\"category\":\"Hierarchy_Model\",\"isFile\":true,\"fileType\":\"text/json\",\"isSystem\":\"$GraphModel$\",\"key\":10,\"location\":\"4973.3245576819 -879.0065037111856\"},\n{\"label\":\"Selection\",\"size\":\"180 60\",\"category\":\"Hierarchy_Selection\",\"isFile\":true,\"fileType\":\"text/json\",\"isSystem\":\"$GraphSelection$\",\"key\":11,\"location\":\"4983.3245576819 -809.0065037111856\"},\n{\"label\":\"Engine Code 1.2\",\"color\":\"orange\",\"size\":\"220 110\",\"category\":\"Hierarchy_CodeInFile\",\"isFile\":true,\"fileTypeName\":\"Javascript\",\"fileType\":\"text/javascript\",\"fileURL\":\"/fileServer/00/90.js\",\"key\":12,\"location\":\"6330 -220\",\"isIncludeScript\":true,\"editorPosition\":[3004,59,703,768]},\n{\"label\":\"Graph Info\",\"category\":\"Hierarchy_GraphInfo\",\"size\":\"180 80\",\"color\":\"SkyBlue\",\"props_\":[{\"name\":\"Name\",\"value\":\"tbd\"},{\"name\":\"Version\",\"value\":\"1.0\"},{\"name\":\"Date\",\"value\":\"@getDate()\"},{\"name\":\"Path\",\"value\":\"./\"},{\"name\":\"Authors\",\"value\":\"Frankonello\"}],\"key\":13,\"location\":\"5183.3245576819 -629.0065037111856\"},\n{\"label\":\"API Keys\",\"category\":\"DataFlow_Param\",\"size\":\"460 80\",\"props_\":[{\"name\":\"ChatGPT\",\"value\":\"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\"}],\"key\":14,\"location\":\"5913.3245576819 -609.0065037111856\"},\n{\"label\":\"Robot Client\",\"category\":\"DataFlow_Component\",\"size\":\"240 80\",\"color\":\"LightSeaGreen\",\"in_\":[{\"portId\":\"message\",\"name\":\"message\"}],\"out_\":[{\"portId\":\"response\",\"name\":\"response\"},{\"portId\":\"status\",\"name\":\"status\"},{\"portId\":\"environmentState\",\"name\":\"environmentState\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"},{\"name\":\"wsURL\",\"value\":\"172.26.1.219:35000\",\"unit\":\"\",\"valueChanged\":\"true\"}],\"isFile\":true,\"fileContent\":\"var nodeData, name, value;\\nEngine_set( nodeData, 'command', value );\\n\\n//--------------------------------\\n// Environment State\\n//--------------------------------\\nvar state = {\\n  gaze: {\\n    fovea: [],\\n    perif: [],\\n  },\\n  hand_left: {\\n    holdsObject: [],\\n    isHeldByObject: [],\\n  },\\n  hand_right:  {\\n    holdsObject: [],\\n    isHeldByObject: [],\\n  },\\n  lab: {\\n    holdsObject:['table_1'],\\n  },\\n  table_1: {\\n    holdsObject: ['fridge_1','microwave_1','toaster_1','plate_1','glass_1','mug_1','pitcher_1','pitcher_2'],\\n    isHeldByObject: ['lab'],\\n  },\\n  fridge_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n    closure: 'closed',\\n    power: 'on',\\n    temperature: -5,\\n  },\\n  microwave_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n    closure: 'closed',\\n    power: 'off',\\n    temperature: 20,\\n  },\\n  toaster_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n    power: 'off',\\n    temperature: 20,\\n  },\\n  plate_1: {\\n    holdsObject: ['toast_1'],\\n    isHeldByObject: ['table_1'],\\n    temperature: 20,\\n  },\\n  toast_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['plate_1'],\\n    temperature: 20,\\n    preparation: 'raw'\\n  },\\n  cola_bottle_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['plate_1'],\\n    closure: 'closed',\\n    temperature: 20,\\n    volume: 0.5,\\n    fillLevel: 0.5,\\n    holdsLiquid: ['coca-cola'],\\n  },\\n  glass_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n    temperature: 20,\\n    volume: 0.1,\\n    fillLevel: 0.0,\\n    holdsLiquid: [],\\n  },\\n  mug_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n    temperature: 'ambiant',\\n    volume: 0.1,\\n    fillLevel: 0.0,\\n    holdsLiquid: [],\\n  },\\n  pitcher_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n    temperature: 20,\\n    volume: 1.0,\\n    fillLevel: 1.0,\\n    holdsLiquid: ['water'],\\n  },\\n  pitcher_2: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n    temperature: 20,\\n    volume: 1.0,\\n    fillLevel: 1.0,\\n    holdsLiquid: ['coffee'],\\n  },\\n  tray_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n  },\\n  tea_bag_1: {\\n    holdsObject: [],\\n    isHeldByObject: ['table_1'],\\n  },\\n};\\nEngine_set( nodeData, 'state', state );\\n\\nfunction updateEnvironmentState() {\\n  const commandStr = Engine_get( nodeData, 'command' );\\n  state = Engine_get( nodeData, 'state' );\\n  tokenList = commandStr.split( ' ' );\\n  if( tokenList ) {\\n    const commandName = tokenList[0] || '';\\n    const objectName1 = tokenList[1] || '';\\n    const objectName2 = tokenList[2] || '';\\n    switch( commandName ) {\\n      case 'get':\\n        if( isHandEmpty( 'right' ) ) {\\n          getObjectInHand( 'right', objectName1 );\\n        } else if( isHandEmpty( 'left' ) ) {\\n          getObjectInHand( 'left', objectName1 );\\n        }\\n        break;\\n      case 'put':\\n        if( isObjectInHand( 'right', objectName1 ) ) {\\n          putObjectOnObject( 'right', objectName2 );\\n        } else if( isObjectInHand( 'left', objectName1 ) ) {\\n          putObjectOnObject( 'left', objectName2 );\\n        }\\n        break;\\n      case 'gaze':\\n        gazeAtObject( objectName1 );\\n        break;\\n      case 'open_door': // valid on microwave and fridge\\n        if( !isObjectOpened( objectName1 ) ) {\\n          setClosure( objectName1, 'opened' );\\n        }\\n        break;\\n      case 'close_door':\\n        if( isObjectOpened( objectName1 ) ) {\\n          setClosure( objectName1, 'closed' );\\n        }\\n        break;\\n      case 'finger_push': // valid on toaster and microwave\\n        if( isObjectPoweredOn( objectName1 ) ) {\\n          setPower( objectName1, 'off' );\\n        } else {\\n          setPower( objectName1, 'on' );\\n        }\\n        break;\\n      case 'pour':\\n        pourObject( objectName1, objectName2 );\\n        break;\\n      case 'screw':\\n        if( isObjectOpened( objectName1 ) ) {\\n          setClosure( objectName1, 'closed' );\\n        } else {\\n          setClosure( objectName1, 'opened' );\\n        }\\n    }\\n  }\\n  console.log(state)\\n  Engine_set( nodeData, 'state', state );\\n}\\nfunction isHandEmpty( side ) {\\n  return( state[`hand_${side}`].holdsObject.length == 0 );\\n}\\nfunction isObjectInHand( side, objectName ) {\\n  return( state[`hand_${side}`].holdsObject.includes( objectName ) );\\n}\\nfunction isObjectOpened( objectName ) {\\n  return( state[objectName].closure == 'opened'? true: false );\\n}\\nfunction setClosure( objectName, status ) {\\n  state[objectName].closure = status;\\n}\\nfunction isObjectPoweredOn( objectName ) {\\n  return( state[objectName].power == 'on'? true: false );\\n}\\nfunction setPower( objectName, status ) {\\n  state[objectName].power = status;\\n}\\nfunction pourObject( fromName1, toName2 ) {\\n  if( state[fromName1].fillLevel >= state[toName2].volume ) {\\n    state[fromName1].fillLevel -= state[toName2].volume;\\n    state[fromName1].fillLevel = Math.max( 0, state[fromName1].fillLevel );\\n  }\\n}\\nfunction getObjectInHand( side, objectName ) {\\n  // Hand now holds objectName \\n  state[`hand_${side}`].holdsObject.push( objectName );\\n  // ObjectName is now holded by hand\\n  const previousHolder = state[objectName].isHeldByObject.shift();\\n  state[objectName].isHeldByObject.push( `hand_${side}` );\\n  // previousHolder does not hold objectName anymore\\n  let objectList = state[previousHolder].holdsObject;\\n  state[previousHolder].holdsObject = objectList.filter( (d)=> d != objectName );\\n}\\nfunction putObjectInHand( side, containerName ) {\\n  containerName = containerName || 'table_1';\\n  // Hand now holds nothing \\n  const objectName = state[`hand_${side}`].holdsObject.shift();\\n  // ObjectName is now holded by containerName\\n  state[objectName].isHeldByObject.shift();\\n  state[objectName].isHeldByObject.push( objectName );\\n  // containerName now holds objectName \\n  state[containerName].holdsObject.push( objectName );\\n}\\nfunction gazeAtObject( objectName ) {\\n  state.gaze.fovea = [objectName];\\n  // Get parent object\\n  const parent = state[objectName].isHeldByObject;\\n  state.gaze.perif = state[parent[0]].holdsObject;\\n}\\n\\nfunction checkIfCommandIsValid( value ) {\\n  return( { isValid: true, errorMsg: '' } );\\n}\\n//--------------------------------\\n// Communication with robot server\\n//--------------------------------\\nfunction sendCommand() {\\n  // Value is the command supposed to be send to the robot client\\n  \\n  // Check if the requested command is a valid one in the current\\n  // state of the environment\\n  const cmdCheckInfo = checkIfCommandIsValid( value );\\n  if( cmdCheckInfo.isValid ) {\\n    ws.send( value );\\n  } else {\\n    Engine_fireOutput( nodeData, 'response', cmdCheckInfo.errorMsg );\\n  }\\n}\\n\\n// Instanciate websocket only one time\\nvar ws = Engine_get( nodeData, 'ws', null );\\nif( !ws ) {\\n  ws = newWS( sendCommand );\\n  Engine_set( nodeData, 'ws', ws );\\n} else {\\n  checkSocketState( ws, sendCommand );\\n}\\n\\nfunction newWS( onConnected  ) {\\n  const wsURL = appData.me.getProperty( modelId, nodeData, 'wsURL' );\\n  let ws = null;\\n  ws = new WebSocket( `ws://${wsURL}/` );\\n  if( ws ) {\\n    ws.onmessage = (event)=> {\\n      const msg = event.data;\\n      Engine_fireOutput( nodeData, 'response', msg );\\n      Engine_fireOutput( nodeData, 'status', 'Received response' );\\n      if( msg == 'Success' ) {\\n        updateEnvironmentState();\\n        const stateMsg = JSON.stringify( state, null, 2 );\\n        Engine_fireOutput( nodeData, 'environmentState', stateMsg );\\n      }\\n    };\\n    ws.onopen = (event)=> {\\n      Engine_fireOutput( nodeData, 'status', 'Open websocket' );\\n      if( onConnected ) {\\n        onConnected();\\n      } \\n    };\\n    ws.onclose = (event)=> {\\n      ws = null;\\n      Engine_set( nodeData, 'ws', ws );\\n      Engine_fireOutput( nodeData, 'status', 'Server not running' );\\n    };\\n    ws.onerror = (event)=> {\\n      Engine_fireOutput( nodeData, 'status', 'Error' );\\n    };\\n    checkSocketState( ws );\\n  }\\n  return( ws );\\n}\\nfunction checkSocketState( ws, onConnected ) {\\n  switch( ws.readyState ){\\n    case 0: // CONNECTING: Socket has been created. The connection is not yet open.\\n      Engine_fireOutput( nodeData, 'status', 'Connecting to websocket' );\\n      break;\\n    case 1: // OPEN: The connection is open and ready to communicate.\\n      Engine_fireOutput( nodeData, 'status', 'Opened websocket' );\\n      if( onConnected ) {\\n        onConnected();\\n      }\\n      break;\\n    case 2: // CLOSING: The connection is in the process of closing.\\n      Engine_fireOutput( nodeData, 'status', 'Closing websocket' );\\n      break;\\n    case 3: // CLOSED: The connection is closed or couldn't be opened.\\n      Engine_fireOutput( nodeData, 'status', 'Server not running' );\\n      break;\\n  }\\n}\\n\",\"fileTypeName\":\"Component\",\"iconURL\":\"/fileServer/pictures/Robot_Server.png\",\"key\":15,\"location\":\"5780 0\",\"fileType\":\"text/javascript\",\"editorPosition\":[2728,14,672,974]},\n{\"label\":\"get glass\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"get glass\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":16,\"location\":\"5270 -10\",\"editorPosition\":[371,718,542,96]},\n{\"label\":\"user defined command\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"put mug_1 tray_1\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":18,\"location\":\"5260 790\",\"editorPosition\":[371,718,542,96],\"color\":\"darkseagreen\"},\n{\"label\":\"screw cola bottle\",\"category\":\"DataFlow_DataSend\",\"size\":\"280 80\",\"buttons_\":[{\"name\":\"Send\",\"checked\":false}],\"in_\":[{\"portId\":\"in\",\"name\":\"in\"}],\"out_\":[{\"portId\":\"out\",\"name\":\"out\"}],\"props_\":[{\"name\":\"isPersistent\",\"value\":\"false\"}],\"isFile\":true,\"fileContent\":\"screw cola_bottle_1\",\"fileTypeName\":\"Text\",\"fileType\":\"text/text\",\"key\":19,\"location\":\"5260 530\",\"editorPosition\":[371,718,542,96]},\n{\"label\":\"\",\"category\":\"Pictures_Basic\",\"size\":\"280 220\",\"isFile\":true,\"fileTypeName\":\"Image\",\"fileType\":\"image/png\",\"fileURL\":\"fileServer/pictures/SMILESimulator.png\",\"key\":20,\"location\":\"5900 -60\"}\n],\n  \"linkDataArray\": [\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":1,\"to\":15,\"points\":[5580.4619140625,440,5590.4619140625,440,5692.193359375,0,5702.193359375,0],\"key\":-1},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":2,\"to\":15,\"points\":[5590.4619140625,350,5600.4619140625,350,5692.193359375,0,5702.193359375,0],\"key\":-2},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":3,\"to\":15,\"points\":[5590.4619140625,260,5600.4619140625,260,5692.193359375,0,5702.193359375,0],\"key\":-3},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":4,\"to\":15,\"points\":[5590.4619140625,170,5600.4619140625,170,5692.193359375,0,5702.193359375,0],\"key\":-4},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":5,\"to\":15,\"points\":[5590.4619140625,80,5600.4619140625,80,5692.193359375,0,5702.193359375,0],\"key\":-5},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"environmentState\",\"toPort\":\"in\",\"from\":15,\"to\":7,\"points\":[6150.73046875,20,6160.73046875,20,6278.103515625,140,6288.103515625,140],\"key\":-6},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"response\",\"toPort\":\"in\",\"from\":15,\"to\":8,\"points\":[6150.73046875,-20,6160.73046875,-20,6688.103515625,150,6698.103515625,150],\"key\":-7},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"status\",\"toPort\":\"in\",\"from\":15,\"to\":9,\"points\":[6150.73046875,0,6160.73046875,0,6288.103515625,610,6298.103515625,610],\"key\":-8},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":16,\"to\":15,\"points\":[5590.4619140625,-10,5600.4619140625,-10,5692.193359375,0,5702.193359375,0],\"key\":-9},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":19,\"to\":15,\"points\":[5580.4619140625,530,5590.4619140625,530,5692.193359375,0,5702.193359375,0],\"key\":-10},\n{\"category\":\"CodeFlow_Code\",\"fromPort\":\"out\",\"toPort\":\"message\",\"from\":18,\"to\":15,\"points\":[5580.4619140625,790,5590.4619140625,790,5691.193359375,0,5692.193359375,0,5702.193359375,0],\"key\":-11}\n]}"
}